{"remainingRequest":"/Users/it_calvin/Desktop/my work/demo/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/it_calvin/Desktop/my work/demo/src/components/pages/Cart.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/it_calvin/Desktop/my work/demo/src/components/pages/Cart.vue","mtime":1653988324368},{"path":"/Users/it_calvin/Desktop/my work/demo/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/it_calvin/Desktop/my work/demo/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/it_calvin/Desktop/my work/demo/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiQ2FydCIsCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGNhcnQ6IHt9LAogICAgICBmb3JtOiB7CiAgICAgICAgdXNlcjogewogICAgICAgICAgbmFtZTogIiIsCiAgICAgICAgfSwKICAgICAgfSwKICAgICAgLy8gaXNMb2FkaW5nOiBmYWxzZSwKICAgIH07CiAgfSwKCiAgbWV0aG9kczogewogICAgZ2V0Q2FydCgpIHsKICAgICAgLy8g5Y+W5b6X6LO854mp6LuK6LOH5paZCiAgICAgIGNvbnN0IHZtID0gdGhpczsKICAgICAgY29uc3QgdXJsID0gYCR7cHJvY2Vzcy5lbnYuVlVFX0FQUF9BUElQQVRIfS9hcGkvJHtwcm9jZXNzLmVudi5WVUVfQVBQX0NVU1RPTVBBVEh9L2NhcnRgOwogICAgICB2bS4kc3RvcmUuZGlzcGF0Y2goInVwZGF0ZUxvYWRpbmciLCB0cnVlKTsKICAgICAgdGhpcy4kaHR0cC5nZXQodXJsKS50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgIHZtLmNhcnQgPSByZXNwb25zZS5kYXRhLmRhdGE7IC8vIOeCuuS6huWwh2NhcnTlhYPku7bluLblhaXvvIzpgJnpgorlhYjkuI3lsIfos4fmlpnluLblhaVjYXJ06ICM5piv5pS55bi25YWl5YiwY2FydEl0ZW0KICAgICAgICAvLyDvvIHpgJnpgorms6jmhI/vvIHvvJrlm6DngrrmmK/opoHliqDlhaXliLDos7znianou4rvvIzlm6DmraTkuIrpnaJkYXRh54mp5Lu25Lit5paw5aKe5LqG5LiA5YCLY2FydOeJqeS7tu+8jOmAmemCiuS5n+imgeWwh+WCs+WFpeeahOizh+aWmeaUueWEsuWtmOWIsGNhcnTkuK3vvIzogIzkuI3mmK9wcm9kdWN0c+S4rQogICAgICAgIGNvbnNvbGUubG9nKCJnZXRDYXJ0IiwgcmVzcG9uc2UpOwogICAgICAgIHZtLmlzTG9hZGluZyA9IGZhbHNlOwogICAgICB9KTsKICAgIH0sCiAgICByZW1vdmVDYXJ0SXRlbShpZCkgewogICAgICAvLyDliKrpmaTos7znianou4rlk4HpoIXvvIzlm6DngrrmmK/opoHliKrpmaTnibnlrprpoIXnm67vvIzlm6DmraTopoHluLblhaVpZOS9nOeCuuWPg+aVuAogICAgICBjb25zdCB2bSA9IHRoaXM7CiAgICAgIGNvbnN0IHVybCA9IGAke3Byb2Nlc3MuZW52LlZVRV9BUFBfQVBJUEFUSH0vYXBpLyR7cHJvY2Vzcy5lbnYuVlVFX0FQUF9DVVNUT01QQVRIfS9jYXJ0LyR7aWR9YDsKICAgICAgdm0uJHN0b3JlLmRpc3BhdGNoKCJ1cGRhdGVMb2FkaW5nIiwgdHJ1ZSk7CiAgICAgIHRoaXMuJGh0dHAuZGVsZXRlKHVybCkudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAvLyB2bS5jYXJ0ID0gcmVzcG9uc2UuZGF0YS5kYXRhOyAvLyDlm6DngrrmmK/opoHliKrpmaTvvIzlm6DmraTmspLlv4XopoHlho3lrZjos4fmlpnpgLJjYXJ0e30KICAgICAgICB2bS5nZXRDYXJ0KCk7IC8vIOWcqOWIqumZpOS7peW+jO+8jOmHjeaWsOi3keS4gOasoWdldENhcnTkvobmm7TmlrDlj4rpoa/npLros7znianou4rliJfooagKICAgICAgICBjb25zb2xlLmxvZygiQ2FydCBJdGVtIHJlbW92ZWQiLCByZXNwb25zZSk7CiAgICAgICAgdm0uJHN0b3JlLmRpc3BhdGNoKCJ1cGRhdGVMb2FkaW5nIiwgZmFsc2UpOwogICAgICB9KTsKICAgIH0sCiAgICBjcmVhdGVPcmRlcigpIHsKICAgICAgY29uc3Qgdm0gPSB0aGlzOwogICAgICBjb25zdCBhcGkgPSBgJHtwcm9jZXNzLmVudi5WVUVfQVBQX0FQSVBBVEh9L2FwaS8ke3Byb2Nlc3MuZW52LlZVRV9BUFBfQ1VTVE9NUEFUSH0vb3JkZXJgOwogICAgICBjb25zdCBvcmRlciA9IHZtLmZvcm07CiAgICAgIC8vIHZtLmlzTG9hZGluZyA9IHRydWU7CiAgICAgIHRoaXMuJHZhbGlkYXRvci52YWxpZGF0ZSgpLnRoZW4oKHJlc3VsdCkgPT4gewogICAgICAgIC8vIOeUqOmAmeautXZhbGlkYXRl5Yqf6IO95L6G6Ziy5q2i6LOH5paZ5pyq6Ly45YWl5a6M5oiQ5bCx6YCy6KGM6YCB5Ye66KiC5Zau55qE5YuV5L2cCiAgICAgICAgaWYgKHJlc3VsdCkgewogICAgICAgICAgdGhpcy4kaHR0cC5wb3N0KGFwaSwgeyBkYXRhOiBvcmRlciB9KS50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgICAvLyDmiophamF46KGM54K65pS+5YWlaWbnmoTmiJDnq4vlvI8KICAgICAgICAgICAgY29uc29sZS5sb2coIuioguWWruW3suW7uueriyIsIHJlc3BvbnNlKTsKICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuc3VjY2VzcykgewogICAgICAgICAgICAgIHZtLiRyb3V0ZXIucHVzaChgY3VzdG9tZXJfY2hlY2tvdXQvJHtyZXNwb25zZS5kYXRhLm9yZGVySWR9YCk7IC8vIOWcqOioguWWruW7uueri+aIkOWKn+S7peW+jO+8jOi3s+i9ieWIsOe1kOW4s+mggemdogogICAgICAgICAgICB9CiAgICAgICAgICAgIHZtLiRzdG9yZS5kaXNwYXRjaCgidXBkYXRlTG9hZGluZyIsIGZhbHNlKTsKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb25zb2xlLmxvZygi5qyE5L2N5LiN5a6M5pW0Iik7CiAgICAgICAgICB2bS4kc3RvcmUuZGlzcGF0Y2goInVwZGF0ZUxvYWRpbmciLCBmYWxzZSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICByZW1vdmVJdGVtKGlkKSB7CiAgICAgIHRoaXMuJGVtaXQoImNhcnRpZCIsIGlkKTsKICAgIH0sCiAgfSwKICBjb21wdXRlZDogewogICAgaXNMb2FkaW5nKCkgewogICAgICByZXR1cm4gdGhpcy4kc3RvcmUuc3RhdGUuaXNMb2FkaW5nOyAvLyDoroDlj5ZzdG9yZS9pbmRleC5qc+ijoeeahHZ1ZXjnrqHnkIbkuK3nmoRpc0xvYWRpbmcKICAgIH0sCiAgfSwKICBtb3VudGVkKCkgewogICAgdGhpcy5nZXRDYXJ0KCk7CiAgfSwKfTsK"},{"version":3,"sources":["Cart.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Cart.vue","sourceRoot":"src/components/pages","sourcesContent":["<template>\n  <div class=\"justify-content-center wrap\">\n    <loading loader=\"bars\" :active.sync=\"isLoading\">\n      <div class=\"loadingio-spinner-ripple-wvqltc293nb\"><div class=\"ldio-4066br826ni\">\n      <div></div><div></div>\n      </div></div>\n    </loading>\n    <!-- 結帳確認頁面 -->\n    <div class=\"checkOut\">\n      <h4>結帳確認</h4>\n    </div>\n    <div class=\"d-flex\">\n      <div class=\"col-md-12 col-sm-12\">\n        <h6>購物車內容</h6>\n        <table class=\"table mt-4\">\n          <thead>\n            <tr>\n              <th colspan=\"2\" width=\"50%\">品名</th>\n              <th width=\"25%\">數量</th>\n              <th width=\"25%\">小記</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr v-for=\"item in cart.carts\" :key=\"item.id\">\n              <td\n                class=\"img-fluid product-img\"\n                :style=\"{backgroundImage: `url(${item.product.imageUrl})`}\"\n              ></td>\n              <td class=\"align-middle\">\n                {{ item.product.title }}\n                <div class=\"text-success\" v-if=\"item.coupon\">已套用優惠券</div>\n              </td>\n              <td class=\"align-middle\">{{ item.qty }}</td>\n              <td class=\"align-middle\">{{ item.qty * item.final_total | currency }}</td>\n            </tr>\n          </tbody>\n\n          <tfoot>\n            <tr>\n              <td colspan=\"3\" class=\"text-right txt-total\">總計</td>\n              <td class=\"text-center txt-total\">{{ cart.total | currency }}</td>\n            </tr>\n            <tr v-if=\"cart.final_total !== cart.total\">\n              <!-- 假設總計價格不等於折扣價時，才會將折扣價格顯示出來 -->\n              <td colspan=\"3\" class=\"text-right text-success txt-total\">折扣價</td>\n              <td class=\"text-center text-success txt-total\">{{ cart.final_total | currency }}</td>\n            </tr>\n          </tfoot>\n        </table>\n\n        <!-- 輸入消費者資訊 -->\n        <!-- 這裡v-if是當購物車沒有任何總金額的時候，就不顯示 -->\n        <div class=\"justify-content-center customer-info\">\n          <form @submit.prevent=\"createOrder\">\n            <h6>請輸入您的資料</h6>\n            <div class=\"form-group\">\n              <label for=\"useremail\">Email</label>\n              <input\n                type=\"email\"\n                class=\"form-control\"\n                name=\"email\"\n                id=\"useremail\"\n                v-validate=\"'required|email'\"\n                :class=\"{'is-invalid': errors.has('email')}\"\n                v-model=\"form.user.email\"\n                placeholder=\"請輸入 Email\"\n              />\n              <!-- Vee-validate帶有內建的驗證功能，這邊寫入 v-validate=\"'required|email'\"會直接去驗證email的輸入是否正確 -->\n              <span class=\"text-danger\" v-if=\"errors.has('email')\">{{ errors.first('email') }}</span>\n              <!-- Vee-validate帶有內建的驗證功能，因此span中寫入{{ errors.first('email') }}會自動帶出相對應的錯誤訊息，比如說沒填寫或格式錯誤 -->\n            </div>\n\n            <div class=\"form-group\">\n              <label for=\"username\">收件人姓名</label>\n              <input\n                type=\"text\"\n                class=\"form-control\"\n                name=\"name\"\n                id=\"username\"\n                :class=\"{'is-invalid': errors.has('name')}\"\n                v-model=\"form.user.name\"\n                v-validate=\"'required'\"\n                placeholder=\"輸入姓名\"\n              />\n              <!-- ⬆️ 在標籤中加入v-validate=\"'required'\"，因為名字比較不限格式，因此後面先不加格式-->\n              <!-- <span class=\"text-danger\">{{ error.has('name') }}</span> -->\n              <!-- ⬆️ 將{{ error.has('name') }}寫在span的內容會有程序上的錯誤，因此須改寫到span的標籤中，並使用v-if來觸發-->\n              <span class=\"text-danger\" v-if=\"errors.has('name')\">姓名必須輸入</span>\n            </div>\n\n            <div class=\"form-group\">\n              <label for=\"usertel\">收件人電話</label>\n              <input\n                type=\"tel\"\n                class=\"form-control\"\n                name=\"tel\"\n                :class=\"{'is-invalid': errors.has('tel')}\"\n                id=\"usertel\"\n                v-model=\"form.user.tel\"\n                v-validate=\"'required'\"\n                placeholder=\"請輸入電話\"\n              />\n              <span class=\"text-danger\" v-if=\"errors.has('tel')\">須輸入電話號碼</span>\n            </div>\n\n            <div class=\"form-group\">\n              <label for=\"useraddress\">收件人地址</label>\n              <input\n                type=\"address\"\n                class=\"form-control\"\n                name=\"address\"\n                :class=\"{'is-invalid': errors.has('address')}\"\n                id=\"useraddress\"\n                v-model=\"form.user.address\"\n                v-validate=\"'required'\"\n                placeholder=\"請輸入地址\"\n              />\n              <span class=\"text-danger\" v-if=\"errors.has('address')\">地址欄位不得留空</span>\n            </div>\n\n            <div class=\"form-group\">\n              <label for=\"useraddress\">留言</label>\n              <textarea name id class=\"form-control\" cols=\"30\" rows=\"10\" v-model=\"form.message\"></textarea>\n            </div>\n            <div class=\"text-left\">\n              <button class=\"btn btn-danger\">送出訂單</button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: \"Cart\",\n  data() {\n    return {\n      cart: {},\n      form: {\n        user: {\n          name: \"\",\n        },\n      },\n      // isLoading: false,\n    };\n  },\n\n  methods: {\n    getCart() {\n      // 取得購物車資料\n      const vm = this;\n      const url = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUSTOMPATH}/cart`;\n      vm.$store.dispatch(\"updateLoading\", true);\n      this.$http.get(url).then((response) => {\n        vm.cart = response.data.data; // 為了將cart元件帶入，這邊先不將資料帶入cart而是改帶入到cartItem\n        // ！這邊注意！：因為是要加入到購物車，因此上面data物件中新增了一個cart物件，這邊也要將傳入的資料改儲存到cart中，而不是products中\n        console.log(\"getCart\", response);\n        vm.isLoading = false;\n      });\n    },\n    removeCartItem(id) {\n      // 刪除購物車品項，因為是要刪除特定項目，因此要帶入id作為參數\n      const vm = this;\n      const url = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUSTOMPATH}/cart/${id}`;\n      vm.$store.dispatch(\"updateLoading\", true);\n      this.$http.delete(url).then((response) => {\n        // vm.cart = response.data.data; // 因為是要刪除，因此沒必要再存資料進cart{}\n        vm.getCart(); // 在刪除以後，重新跑一次getCart來更新及顯示購物車列表\n        console.log(\"Cart Item removed\", response);\n        vm.$store.dispatch(\"updateLoading\", false);\n      });\n    },\n    createOrder() {\n      const vm = this;\n      const api = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUSTOMPATH}/order`;\n      const order = vm.form;\n      // vm.isLoading = true;\n      this.$validator.validate().then((result) => {\n        // 用這段validate功能來防止資料未輸入完成就進行送出訂單的動作\n        if (result) {\n          this.$http.post(api, { data: order }).then((response) => {\n            // 把ajax行為放入if的成立式\n            console.log(\"訂單已建立\", response);\n            if (response.data.success) {\n              vm.$router.push(`customer_checkout/${response.data.orderId}`); // 在訂單建立成功以後，跳轉到結帳頁面\n            }\n            vm.$store.dispatch(\"updateLoading\", false);\n          });\n        } else {\n          console.log(\"欄位不完整\");\n          vm.$store.dispatch(\"updateLoading\", false);\n        }\n      });\n    },\n    removeItem(id) {\n      this.$emit(\"cartid\", id);\n    },\n  },\n  computed: {\n    isLoading() {\n      return this.$store.state.isLoading; // 讀取store/index.js裡的vuex管理中的isLoading\n    },\n  },\n  mounted() {\n    this.getCart();\n  },\n};\n</script>\n\n<style scoped>\n.wrap {\n  max-width: 1200px;\n  margin: 0 auto;\n}\n\n.checkOut {\n  max-width: 1200px;\n  border-bottom: 0.5px grey dotted;\n  text-align: center;\n  margin: 10px 0 20px 0;\n}\n\n.table {\n  margin: 0 auto;\n  width: 70%;\n  justify-content: center;\n  align-items: center;\n}\n\ntbody {\n  height: 50px;\n}\n\ntd {\n  align-items: center;\n  justify-content: center;\n}\n\n.product-img {\n  background-size: contain;\n  background-repeat: no-repeat;\n  background-position: 50% 50%;\n}\n\n.form-group {\n  text-align: left;\n}\n\n.customer-info {\n  margin: 20px auto 0 auto;\n  width: 60%;\n  justify-content: center;\n  align-items: center;\n}\n\n@media(max-width: 767px){\n  .table{\n    width: 100%;\n  }\n\n  .customer-info{\n    width: 100%;\n  }\n}\n\n@keyframes ldio-4066br826ni {\n  0% {\n    top: 95.88px;\n    left: 95.88px;\n    width: 0;\n    height: 0;\n    opacity: 1;\n  }\n  100% {\n    top: 58.14px;\n    left: 58.14px;\n    width: 75.48px;\n    height: 75.48px;\n    opacity: 0;\n  }\n}\n\n.ldio-4066br826ni div {\n  position: absolute;\n  border-width: 6.12px;\n  border-style: solid;\n  opacity: 1;\n  border-radius: 50%;\n  animation: ldio-4066br826ni 1.0416666666666665s cubic-bezier(0,0.2,0.8,1) infinite;\n}\n\n.ldio-4066br826ni div:nth-child(1) {\n  border-color: #12cfc9\n}\n\n.ldio-4066br826ni div:nth-child(2) {\n  border-color: #3ea8bc;\n  animation-delay: -0.5208333333333333s;\n}\n\n.loadingio-spinner-ripple-wvqltc293nb {\n  width: 204px;\n  height: 204px;\n  display: inline-block;\n  overflow: hidden;\n}\n.ldio-4066br826ni {\n  width: 100%;\n  height: 100%;\n  position: relative;\n  transform: translateZ(0) scale(1);\n  backface-visibility: hidden;\n  transform-origin: 0 0; /* see note above */\n}\n.ldio-4066br826ni div { box-sizing: content-box; }\n</style>"]}]}