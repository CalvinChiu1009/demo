{"remainingRequest":"/Users/it_calvin/Desktop/my work/demo/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/it_calvin/Desktop/my work/demo/src/components/pages/CustomerCheckout.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/it_calvin/Desktop/my work/demo/src/components/pages/CustomerCheckout.vue","mtime":1653988324368},{"path":"/Users/it_calvin/Desktop/my work/demo/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/it_calvin/Desktop/my work/demo/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/it_calvin/Desktop/my work/demo/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhKCkgewogICAgLy8g5a6a576p6LOH5paZ57WQ5qeLCiAgICByZXR1cm4gewogICAgICBvcmRlcjogewogICAgICAgIHVzZXI6IHsKICAgICAgICAgIGFkZHJlc3M6ICIiLAogICAgICAgICAgZW1haWw6ICIiLAogICAgICAgICAgdGVsOiAiIiwKICAgICAgICAgIG5hbWU6ICIiCiAgICAgICAgfQogICAgICB9LAogICAgICBvcmRlcklkOiAiIiAvLyDlrZjmlL7oqILllq7omZ/norwKICAgIH07CiAgfSwKICBtZXRob2RzOiB7CiAgICBnZXRPcmRlcigpIHsKICAgICAgLy8g5Y+W5b6X6KiC5Zau6LOH5paZCiAgICAgIGNvbnN0IHZtID0gdGhpczsKICAgICAgY29uc3QgdXJsID0gYCR7cHJvY2Vzcy5lbnYuVlVFX0FQUF9BUElQQVRIfS9hcGkvJHtwcm9jZXNzLmVudi5WVUVfQVBQX0NVU1RPTVBBVEh9L29yZGVyLyR7dm0ub3JkZXJJZH1gOyAvLyDlj5blvpfoqILllq7os4fmlpkKICAgICAgdm0uJHN0b3JlLmRpc3BhdGNoKCJ1cGRhdGVMb2FkaW5nIiwgdHJ1ZSk7CiAgICAgIHRoaXMuJGh0dHAuZ2V0KHVybCkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgdm0ub3JkZXIgPSByZXNwb25zZS5kYXRhLm9yZGVyOwogICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTsKICAgICAgICB2bS4kc3RvcmUuZGlzcGF0Y2goInVwZGF0ZUxvYWRpbmciLCBmYWxzZSk7CiAgICAgIH0pOwogICAgfSwKICAgIHBheU9yZGVyKCkgewogICAgICAvLyDnorroqo3ku5jmrL4KICAgICAgY29uc3Qgdm0gPSB0aGlzOwogICAgICBjb25zdCB1cmwgPSBgJHtwcm9jZXNzLmVudi5WVUVfQVBQX0FQSVBBVEh9L2FwaS8ke3Byb2Nlc3MuZW52LlZVRV9BUFBfQ1VTVE9NUEFUSH0vcGF5LyR7dm0ub3JkZXJJZH1gOyAvLyDnorroqo3ku5jmrL7nmoRhcGnot6/lvpEKICAgICAgdm0uJHN0b3JlLmRpc3BhdGNoKCJ1cGRhdGVMb2FkaW5nIiwgdHJ1ZSk7CiAgICAgIHRoaXMuJGh0dHAucG9zdCh1cmwpLnRoZW4ocmVzcG9uc2UgPT4geyAvLyDlm6DngrrmmK/lsIfoqILllq7nmbzpgIHlh7rljrvvvIzlm6DmraRhamF46KGM54K66KaB5pS554K6cG9zdAogICAgICAgIC8vIHZtLm9yZGVyID0gcmVzcG9uc2UuZGF0YS5vcmRlcjsgLy8g5LuY5qy+6KGM54K65Y+v5Lul55yB5Y676YCZ5LiA6KGMCiAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpOwogICAgICAgIGlmKHJlc3BvbnNlLmRhdGEuc3VjY2VzcykgewogICAgICAgICAgICBhbGVydCgn5LuY5qy+5oiQ5Yqf77yM5YaN5Y675oiR5YCR55qE6LOj5aC055yL55yL5ZCn77yBJykKICAgICAgICAgICAgdm0uZ2V0T3JkZXIoKTsKICAgICAgICAgICAgdm0uJHJvdXRlci5wdXNoKGAvcHJvZHVjdF9saXN0YCk7CiAgICAgICAgfQogICAgICAgIHZtLiRzdG9yZS5kaXNwYXRjaCgidXBkYXRlTG9hZGluZyIsIGZhbHNlKTsKICAgICAgfSk7CiAgICB9LAogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIGlzTG9hZGluZygpIHsKICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLnN0YXRlLmlzTG9hZGluZzsKICAgIH0sCiAgfSwKICBjcmVhdGVkKCkgewogICAgLy8gdGhpcy5vcmRlcklkID0gdGhpcy4kcm91dGUucGFyYW1zLm9yZGVySWQ7IC8vIOmAmeijoSRyb3V0ZS5wYXJhbXPnmoRwYXJhbXPmmK/lj5blvpfot6/lvpHkuIrnmoTlj4PmlbjvvIzpgJnpgorljbPmmK9vcmRlcklkCiAgICBjb25zb2xlLmxvZyh0aGlzLm9yZGVySWQpOyAvLyDmqqLmn6XoqILllq7omZ/norzmmK/lkKbmnInnrKblkIjot6/lvpHlkI3nqLEKICAgIHRoaXMuZ2V0T3JkZXIoKTsKICB9Cn07Cg=="},{"version":3,"sources":["CustomerCheckout.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"CustomerCheckout.vue","sourceRoot":"src/components/pages","sourcesContent":["<template>\n  <div class=\"my-5 row justify-content-center\">\n    <form class=\"col-md-6\" @submit.prevent=\"payOrder\">\n      <table class=\"table col-sm-12\">\n        <thead>\n          <th>品名</th>\n          <th>數量</th>\n          <th>單價</th>\n        </thead>\n        <tbody>\n          <tr v-for=\"item in order.products\" :key=\"item.id\">\n            <td class=\"align-middle\">{{ item.product.title }}</td>\n            <td class=\"align-middle\">{{ item.qty }}/{{ item.product.unit }}</td>\n            <td class=\"align-middle text-right\">{{ item.final_total }}</td>\n          </tr>\n        </tbody>\n        <tfoot>\n          <tr>\n            <td colspan=\"2\" class=\"text-right\">總計</td>\n            <td class=\"text-right\">{{ order.total }}</td>\n          </tr>\n        </tfoot>\n      </table>\n\n      <table class=\"table col-sm-12\">\n        <tbody>\n          <tr>\n            <th width=\"100\">Email</th>\n            <td>{{ order.user.email }}</td>\n          </tr>\n          <tr>\n            <th>姓名</th>\n            <td>{{ order.user.name }}</td>\n          </tr>\n          <tr>\n            <th>收件人電話</th>\n            <td>{{ order.user.tel }}</td>\n          </tr>\n          <tr>\n            <th>收件人地址</th>\n            <td>{{ order.user.address }}</td>\n          </tr>\n          <tr>\n            <th>付款狀態</th>\n            <td>\n              <span v-if=\"!order.is_paid\">尚未付款</span>\n              <span v-else class=\"text-success\">付款完成</span>\n            </td>\n          </tr>\n        </tbody>\n      </table>\n      <div class=\"text-right\" v-if=\"order.is_paid === false\">\n        <button class=\"btn btn-danger\">確認付款去</button>\n      </div>\n    </form>\n  </div>\n</template>\n\n<script>\nexport default {\n  data() {\n    // 定義資料結構\n    return {\n      order: {\n        user: {\n          address: \"\",\n          email: \"\",\n          tel: \"\",\n          name: \"\"\n        }\n      },\n      orderId: \"\" // 存放訂單號碼\n    };\n  },\n  methods: {\n    getOrder() {\n      // 取得訂單資料\n      const vm = this;\n      const url = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUSTOMPATH}/order/${vm.orderId}`; // 取得訂單資料\n      vm.$store.dispatch(\"updateLoading\", true);\n      this.$http.get(url).then(response => {\n        vm.order = response.data.order;\n        console.log(response);\n        vm.$store.dispatch(\"updateLoading\", false);\n      });\n    },\n    payOrder() {\n      // 確認付款\n      const vm = this;\n      const url = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUSTOMPATH}/pay/${vm.orderId}`; // 確認付款的api路徑\n      vm.$store.dispatch(\"updateLoading\", true);\n      this.$http.post(url).then(response => { // 因為是將訂單發送出去，因此ajax行為要改為post\n        // vm.order = response.data.order; // 付款行為可以省去這一行\n        console.log(response);\n        if(response.data.success) {\n            alert('付款成功，再去我們的賣場看看吧！')\n            vm.getOrder();\n            vm.$router.push(`/product_list`);\n        }\n        vm.$store.dispatch(\"updateLoading\", false);\n      });\n    },\n  },\n  computed: {\n    isLoading() {\n      return this.$store.state.isLoading;\n    },\n  },\n  created() {\n    // this.orderId = this.$route.params.orderId; // 這裡$route.params的params是取得路徑上的參數，這邊即是orderId\n    console.log(this.orderId); // 檢查訂單號碼是否有符合路徑名稱\n    this.getOrder();\n  }\n};\n</script>\n"]}]}